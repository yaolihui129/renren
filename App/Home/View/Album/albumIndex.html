<extend name="Public/Base" />
<block name="main-css">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/home/css/base.css">
    <link rel="stylesheet" href="__PUBLIC__/home/css/albumList.css">
    <link rel="stylesheet" href="__PUBLIC__/home/css/uploadAndCreate.css">
    <link href="__PUBLIC__/home/css/webpager.css" rel="stylesheet">
    <link href="__PUBLIC__/home/css/roomkeeper.css" rel="stylesheet">
    <link href="__PUBLIC__/home/css/advert.css" rel="stylesheet">
    
</block>
<block name="main-body">
<div class="frame-nav-wrap">
    <div style="width: 1189px;" id="frameFixedNav" class="frame-nav-fixed-wraper">
        <div class="frame-nav-inner">
            <ul class="fd-nav-list clearfix">
                <li class="fd-nav-item">
                    <span class="fd-nav-icon fd-sub-nav">
                    </span>
                    <!-- <a href="__MODULE__/UserPage/index/id/{$Think.get.id}"> -->
                    <a href="__MODULE__/UserPage/userPageIndex/id/{$Think.get.id}">
                        W的主页
                    </a>
                </li>
                <li class="fd-nav-item">
                    <a href="__MODULE__/Profile/profileIndex/id/{$Think.get.id}">
                        资料
                    </a>
                </li>
                <li class="fd-nav-item fd-nav-cur-item">
                    <a href="__MODULE__/Album/albumIndex/id/{$Think.get.id}">
                        相册
                    </a>
                </li>
                <li class="fd-nav-item">
                    <a href="__MODULE__/Share/index/id/{$Think.get.id}">
                        分享
                    </a>
                </li>
                <li class="fd-nav-item">
                    <a href="__MODULE__/SelfNews/index/id/{$Think.get.id}/type/0">
                        状态
                    </a>
                </li>
                <li class="fd-nav-item">
                    <a href="__MODULE__/SelfNews/index/id/{$Think.get.id}/type/1">
                        日志
                    </a>
                </li>
                <li class="fd-nav-item">
                    <a href="__MODULE__/Friend/index/id/{$Think.get.id}">
                        好友
                    </a>
                </li>
                <li class="fd-nav-item fd-nav-showmore">
                    <a href="#">
                        更多
                        <em class="fd-arr-down">
                            <span class="fd-arr-outer">
                                <span class="fd-arr-inner">
                                </span>
                            </span>
                        </em>
                    </a>
                    <div class="nf-group-list-container">
                        <ul class="nf-group-list">
                            <li class="nf-group-item">
                                <a href="http://follow.renren.com/list/885992102/sub/v7">
                                    关注
                                </a>
                            </li>
                            <li class="nf-group-item">
                                <a href="http://photo.renren.com/photo/zuji/885992102" target="_blank">
                                    足迹
                                </a>
                            </li>
                            <li class="nf-group-item">
                                <a href="http://gift.renren.com/show/box/otherbox?userId=885992102" target="_blank">
                                    礼物
                                </a>
                            </li>
                            <li class="nf-group-item">
                                <a href="http://page.renren.com/home/mypages" target="_blank">
                                    公共主页
                                </a>
                            </li>
                            <li class="nf-group-item">
                                <a href="http://www.renren.com/lifeevent/index/885992102">
                                    生活纪事
                                </a>
                            </li>
                            <li class="nf-group-item">
                                <a href="http://mvideo.renren.com/video/885992102/list">
                                    短视频
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<!------ 主体内容 ------>
<div class="bd-main">
    <div class="bd-content clearfix">
        <div class="album-list-main clearfix">
            <!------ 相册上部横条 ------>
            <div class="album-list-bar">
                <ul id="album-tab">
                    <li>
                        <a class="a-b-t" href="http://photo.renren.com/photo/885992102/latest/v7">
                            最近照片
                        </a>
                    </li>
                    <li>
                        <a class="a-b-t" href="http://photo.renren.com/photo/885992102/tag/v7">
                            被圈照片
                        </a>
                    </li>
                    <li>
                        <a class="a-b-t a-b-t-hover" href="http://photo.renren.com/photo/885992102/albumlist/v7">
                            我的相册
                        </a>
                    </li>
                </ul>
                <div class="album-ctrl">
                    <div class="album-btn">
                        <!-- <a class="a-b-btn btn-upload">
                        </a> -->
                        <a class="a-b-btn btn-create" onclick="openPage()">
                        </a>
                    </div>
                </div>
            </div>
            <div class="album-list" style="min-height: 212px;">
                <ul class="a-b-tab" id="album-list">
                    <!------ 循环遍历相册处 ------>
                    <foreach name="albumList" item="vo">
                        <li class="album-box" id="album-box-1127956402">
                            <a id="album-1127956402" class="album-item album-bg-fews" href="javascript:void(0)">
                                <img class="album-cover" src="__PUBLIC__/upload/images/{$vo.cover|default='200.png'}" onclick="location.href='__MODULE__/Pic/picIndex/id/{$info.id}/aid/{$vo.id}'" style="max-height:162px;max-width:232px;">
                                <span del-data="{$vo.id}" onclick="del(this)" class="album-del-icon">
                                    <span class="btn-del-album" del-data="1127956402">
                                    </span>
                                </span>
                            </a>
                            <span class="album-count">
                                {$vo.picNum}
                            </span>
                            <div class="album-info">
                                <a class="album-name"  title="封面相册" src="__PUBLIC__/home/images/{$albumList.cover}" href="__MODULE__/Pic/picIndex/id/{$info.id}/aid/{$vo.id}">
                                    {$vo.title}
                                </a>
                                <!-- <span class="album-limit" id="limit-box-1127956402">
                                    <switch name="vo.status">
                                        <case value="0">私人相册</case>
                                        <case value="1">好友可见</case>
                                        <case value="2">所有可见</case>
                                    </switch>
                                </span> -->
                            </div>
                        </li>
                    </foreach>
                        
                </ul>
            </div>
        </div>
    </div>
</div>
<!------ 添加相册界面 ------>
<div id="pageBack" class="ui-widget-overlay ui-front" style="display:none"></div>
<div id="addPage" class="ui-dialog ui-widget ui-front" tabindex="-1" style="height: auto; width: 522px; top: 79px; left: 412.5px;display:none">
    <div class="ui-widget-header ui-helper-clearfix">
        <span id="ui-id-2" class="ui-dialog-title">
        </span>
        <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-close"
        role="button"  onclick="closePage()" title="关闭">
            <span class="ui-button-icon-primary ui-icon-lclose ui-iconfont"><b>×</b></span>
        </button>
    </div>
    <input type="hidden" id="userId" value={$info.id}>
    <div id="create-box" class="ui-widget-content" style="display: block; width: auto; min-height: 38px; max-height: none; height: auto;">
        <ul class="c-b-tab">
            <li class="c-b-i">
                <a class="c-b-n" href="javascript:void(0);">
                    新建相册
                </a>
            </li>
        </ul>
        <div class="c-b-box">
            <label class="c-i-list">
                <span class="c-b-name">
                    相册名：
                </span>
                <input class="c-b-input c-b-input-ok" type="text" id="title">
                <div class="c-b-erro">
                    <span class="c-b-limit-num limit-num-error" id="c-b-album-nm-limit">
                        
                    </span>
                    
                </div>
            </label>
            <label class="c-i-list">
                <span class="c-b-name">
                    描述：
                </span>
                <textarea class="c-b-input c-b-input-ok" id="des" style="height: 100px;resize: none;"></textarea>
                <div class="c-b-erro">
                    <span class="c-b-limit-num" id="c-b-album-des-limit">
                        
                    </span>
                    
                </div>
            </label>
            <label class="c-i-list">
                <span class="c-b-name">
                    地点：
                </span>
                <input class="c-b-input c-b-input-ok" type="text" id="address">
                <div class="c-b-erro">
                    <span class="c-b-limit-num" id="c-b-album-plc-limit">
                    
                    </span>
                    
                </div>
            </label>
            <!-- <label class="c-i-list">
                <span class="c-b-name">
                    类别：
                </span>
                <select class="c-b-input c-b-input-ok" name="" id="status">
                    <option value="0">仅自己可见</option>
                    <option value="1">好友可见</option>
                    <option value="2">全部可见</option>
                </select>
            </label> -->
        </div>
    </div>
    <div class="ui-widget-footer ui-helper-clearfix">
        <div class="ui-dialog-buttonset">
            <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" onclick="closePage()"
            >
                <span class="ui-button-text">
                    取消
                </span>
            </button>
            <button type="button" id="btn-sbm-create" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" disabled onclick="submitPage()">
                <span class="ui-button-text">
                    确定
                </span>
            </button>
        </div>
    </div>
</div>
<div id="readyToAdd" style="display:none">
    <li class="album-box" id="album-box-1127956402">
        <a id="album-1127956402" class="album-item album-bg-fews" href="javascript:void(0)">
            <img class="album-cover" src="__PUBLIC__/upload/images/200.png" onclick="location.href='__MODULE__/Pic/picIndex/id/{$info.id}/aid/{$vo.id}'" thisType="cover">
            <span del-data="" onclick="del(this)" class="album-del-icon">
                <span class="btn-del-album" del-data="1127956402">
                </span>
            </span>
        </a>
        <span class="album-count" id="readyPicNum">0
        </span>
        <div class="album-info">
            <a class="album-name" id="readyTitle" >
            </a>
            <span class="album-limit" id="limit-box-1127956402">
            </span>
        </div>
    </li>
    
</div>
<script type="text/javascript">
    function closePage(){
        $('#addPage,#pageBack').hide();
    }
    function openPage(){
        $('#addPage,#pageBack').show();
    }
    function submitPage(){
        var title = $('#title').val();
        var des = $('#des').val();
        var address = $('#address').val();
        var id = $('#userId').val();
        // console.log(title,des,address,status,id);
        $.ajax({
            url:'__MODULE__/Album/add',
            type:'POST',
            dataType:'text',
            data:'title='+title+'&des='+des+'&address='+address+'&status='+status+'&id='+id,
            success:function(data){
                if(data>0){
                    $('#tanchaungneirong').html('相册添加成功');
                    $('#tanchuang').show();
                    closePage();
                    $('#readyTitle').html(title);
                    $('#readyToAdd').find('.album-del-icon').attr('del-data',data);
                    var str = $('#readyToAdd').html();
                    $('#album-list').append(str);
                }else{
                    $('#tanchaungneirong').html('相册添加失败，原因：'+data);
                    $('#tanchuang').show();
                }
            }
        });
    }
    function del(res){
        if(!confirm('确定要删除吗？')){
            return;
        }
        var id = $(res).attr('del-data');
        $.ajax({
            url:'__MODULE__/Album/del',
            type:'POST',
            dataType:'text',
            data:'id='+id,
            success:function(data){
                if(data == 'y'){
                    $('#tanchaungneirong').html('删除成功');
                    $('#tanchuang').show();
                    $(res).parents('li').remove();
                }else{
                    $('#tanchaungneirong').html('删除失败，原因：'+data);
                    $('#tanchuang').show();
                }
            }
        });
        return false;
    }
    $(function(){
        $('li[data-tip="首页"]').removeClass('app-nav-item-cur');
        $('li[data-tip="我的相册"]').addClass('app-nav-item-cur');
        $('.nx-main760 .hd-nav, .nx-main760 .bd-content, .nx-main760 .frame-nav-inner').css('width','870px');
    });
    // 检测相册名
    $('#title').blur(function(){
        var title = $(this).val();
        $.ajax({
            url:'__MODULE__/Album/checkTitle',
            type:'POST',
            dataType:'text',
            data:'title='+title,
            success:function(data){
                if(data == 'y'){
                    $('#btn-sbm-create').attr('disabled',false);
                }else{
                    $('#btn-sbm-create').attr('disabled',true);
                    $(this).removeClass('c-b-input-ok');
                    $(this).addClass('c-b-input-error');
                }
            }
        });
    });
</script>
</block>